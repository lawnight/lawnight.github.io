---
title: 链路层
categories: network
---
TCP/IP支持很多不同的链路层协议，这取决于网络所使用的硬件，如以太网、令牌环网、FDDI（光纤分布式数据接口）及RS-232串行线路等。我们只关注常见的几个。

#1. IEEE 802协议
Institute of Electrical and Electronics Engineers(IEEE)是美国的电子电气工程师协会。所有的`IEEE 802`标准是为了满足家庭和企业网络的应用；802随着时间发展出了很多协议，其中最广泛的是`802.3`（essentially Ethernet）和`802.11`（WLAN/Wi-Fi）。在IEEE的设计概念里，是有物理层的。
**和tcpip协议相关的一些IEEE 802标准:**
Name | Description| Official Reference
---|---|--
802.1w| Rapid Spanning Tree Protocol (RSTP) |[802.1D-2004]
802.2 | Logical Link Control (LLC) | [802.2-1998]
802.3 |Baseline Ethernet and 10Mb/s Ethernet| [802.3-2008] (Section One) 
802.3u| 100Mb/s Ethernet (“Fast Ethernet”)| [802.3-2008] (Section Two)
802.3z/802.3ab |1000Mb/s Ethernet (“Gigabit Ethernet”)| [802.3-2008] (Section Three)
802.3ae |10Gb/s Ethernet (“Ten-Gigabit Ethernet”) |[802.3-2008] (Section Four)
802.11a |54Mb/s Wireless LAN at 5GHz |[802.11-2007] 
802.11b |11Mb/s Wireless LAN at 2.4GHz |[802.11-2007]
802.11n| 6.5–600Mb/s Wireless LAN at 2.4 and 5GHz using optional MIMO and 40MHz channels|[802.11n-2009]

这个方法叫做：`carrier sense, multiple access with collision detection (CSMA/CD)`。是一个
MAC协议（Media Access Control）。电脑可以访问共享的线路（shared medium）不需要任何的确认和同步。


##以太网帧（Ethernet frames）

`Ethernet II`最常使用的格式。是几家大公司协定的协议，随后被IEEE标准化为`802.3`。最开始标准和实际还是有细微局别，最后IEEE标准允许其中一个字段既可以为Length也可以为Type。当`Ethernet II`定义的`EtherType`大于等于1536（ox0600），这两种格式就能同时在一个物理媒介上运行。

**IEEE 802.3 packet and frame format**:
![1](/assets/link1.png)


IEEE Packet是物理层相关的，`preamble`和`SFD`都是物理层使用的。`preamble`是交替的1和0,像这样`10101010 10101010 10101010 10101010 10101010 10101010 10101010`,SFD 是`0xAB`,标识preamble的结束。这些数据用来让接受者的电路做`clock recovery`。暂未做深入分析，涉及物理层。

>最初以太网位编码是用Manchester Phase Encoding (MPE)。用电压变化而不是绝对值表示0或1。 -0.85到+0.85V表示0，+0.85v到-0.85v表示1。
`IEEE 802.2`




### Frame sizes
最小64字节，如果不够，会在末尾加pad。一个空的TCP包是60直接，所有会有pad。传统以太网最大为1518字节。一种提高大数据传输性能的方法是使用非标准的巨型帧，但是只能在特定环境下使用，因为大多以太网设备不支持。

#2. vlan
`802.1q`标准，virtual LANs。将大局域网拆分成更小的lan。

电信的网络和电视就分属于不同的vlanId。看电视和上网需要插入对应的lan口上，如果家里拉线，只拉了一根线，那么只能上网，或者只能看电视。用支持vlan的交换机，就能够单线复用了。



#3. 桥接和交换机

交换机本质上就是高性能的桥接。交换机和网桥可以组成大的局域网。
![](/assets/link2.png)

交换机会对每个端口自动映射对应的mac地址，存储在filtering databases。当第一次启动，database是空的时候，交换机会将数据包拷贝多份，发送到每个交换机端口。


多个交换机并且有循环的links。可能造成广播风暴（broadcast storm）。STP协议可以解决这个问题。
![](/assets/link3.png)

路由器实现了网络层，比交换机拥有更多的功能。如下图，不过这是理想情况下，实际上路由器为了方便管理，一般都有web界面，实际上是实现了应用层的。

![](/assets/link4.png)




# PPP

Point-to-Point Protocol.是一系列协议，常用来在串行线路（serial links）上发送IP数据包。

## ppp over Ethernet。
---
##参考
>1. TCPIP详解 
>2. 单线复用、单线多用和vlan的理解：https://www.right.com.cn/forum/forum.php?mod=viewthread&tid=309204&page=1#pid2503294
>3. Ethernet_frame: https://en.wikipedia.org/wiki/Ethernet_frame
https://en.wikipedia.org/wiki/Ethernet_physical_layer
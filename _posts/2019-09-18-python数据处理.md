---
title: python数据简单处理
categories: python
---
# xml处理

常见的库为`xml`和`lxml`,`lxml`包含更多的功能，并且可以解析lxml和xml。

- 读取解析xml文件。并得到root element
```python
from lxml import etree
root = etree.fromstring('')
#ElementTree
tree = etree.parse('filePath')
root = tree.getroot()
```

## element

通过getchildren方法，或者直接迭代，得到子element。

```python
for child in root.getchildren():
    pass
for child in root:
    pass
```

`ele.tag` 得到标签名
`ele.attrib['name']`  得到属性

```python
for child in root.getchildren():
    if child.tag == 'struct':
        child.get('desc')
```


# html处理

```python
from lxml import etree
html = etree.HTML(data.text)
html.xpath('xpath')
```


# json处理

```python
import json
string = json.dumps(map)
json.loads('')
json.load(file)
```

# excle
```python
# 读取excel的当前sheet页
d = pd.read_excel(r"D:\code\br_mix_server\excel\common\ConfigValue.xlsx",sheet_name='任务',skiprows=5)
# 读取所有sheet页
c = pd.concat(pd.read_excel(r'D:\code\br_mix_server\excel\common\ConfigValue.xlsx',sheet_name=None))

# 得到excel所有的sheet names
d = pd.ExcelFile(r"D:\code\br_mix_server\excel\common\ConfigValue.xlsx")
d.sheet_names
```